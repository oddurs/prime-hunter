# PostgreSQL host-based authentication for darkreach
#
# TYPE  DATABASE  USER         ADDRESS           METHOD

# Local connections (coordinator)
local   all       darkreach                      scram-sha-256
local   all       postgres                       peer

# Coordinator (localhost)
host    all       darkreach    127.0.0.1/32      scram-sha-256
host    all       darkreach    ::1/128           scram-sha-256

# Worker nodes (Hetzner private network 10.0.0.0/8)
host    all       darkreach    10.0.0.0/8        scram-sha-256

# Streaming replication (replica server)
host    replication  replicator  10.0.0.0/8      scram-sha-256

# Reject everything else
host    all       all          0.0.0.0/0         reject
